import express from "express";

// ÐœÐ°ÑÐ¸Ð² ÑƒÑÑ–Ñ… Ñ‡ÐµÐ¼Ð¿Ñ–Ð¾Ð½Ñ–Ð² League of Legends
const champions = [
  "Aatrox", "Ahri", "Akali", "Alistar", "Amumu", "Anivia", "Annie", "Aphelios",
  "Ashe", "Aurelion Sol", "Azir", "Bard", "Bel'Veth", "Blitzcrank", "Brand",
  "Braum", "Briar", "Caitlyn", "Camille", "Cassiopeia", "Cho'Gath", "Corki",
  "Darius", "Diana", "Dr. Mundo", "Draven", "Ekko", "Elise", "Evelynn", "Ezreal",
  "Fiddlesticks", "Fiora", "Fizz", "Galio", "Gangplank", "Garen", "Gnar", "Gragas",
  "Graves", "Gwen", "Hecarim", "Heimerdinger", "Hwei", "Illaoi", "Irelia", "Ivern",
  "Janna", "Jarvan IV", "Jax", "Jayce", "Jhin", "Jinx", "K'Sante", "Kai'Sa",
  "Kalista", "Karma", "Karthus", "Kassadin", "Katarina", "Kayle", "Kayn", "Kennen",
  "Kha'Zix", "Kindred", "Kled", "Kog'Maw", "LeBlanc", "Lee Sin", "Leona", "Lillia",
  "Lissandra", "Lucian", "Lulu", "Lux", "Malphite", "Malzahar", "Maokai", "Master Yi",
  "Milio", "Miss Fortune", "Mordekaiser", "Morgana", "Naafiri", "Nami", "Nasus",
  "Nautilus", "Neeko", "Nidalee", "Nilah", "Nocturne", "Nunu & Willump", "Olaf",
  "Orianna", "Ornn", "Pantheon", "Poppy", "Pyke", "Qiyana", "Quinn", "Rakan",
  "Rammus", "Rek'Sai", "Rell", "Renata Glasc", "Renekton", "Rengar", "Riven",
  "Rumble", "Ryze", "Samira", "Sejuani", "Senna", "Seraphine", "Sett", "Shaco",
  "Shen", "Shyvana", "Singed", "Sion", "Sivir", "Skarner", "Smolder", "Sona",
  "Soraka", "Swain", "Sylas", "Syndra", "Tahm Kench", "Taliyah", "Talon", "Taric",
  "Teemo", "Thresh", "Tristana", "Trundle", "Tryndamere", "Twisted Fate", "Twitch",
  "Udyr", "Urgot", "Varus", "Vayne", "Veigar", "Vel'Koz", "Vex", "Vi", "Viego",
  "Viktor", "Vladimir", "Volibear", "Warwick", "Wukong", "Xayah", "Xerath",
  "Xin Zhao", "Yasuo", "Yone", "Yorick", "Yuumi", "Zac", "Zed", "Zeri", "Ziggs",
  "Zilean", "Zoe", "Zyra"
];

const app = express();
const PORT = process.env.PORT || 3000;

// Middleware Ð´Ð»Ñ Ð»Ð¾Ð³ÑƒÐ²Ð°Ð½Ð½Ñ Ð·Ð°Ð¿Ð¸Ñ‚Ñ–Ð²
app.use((req, res, next) => {
  console.log(`[${new Date().toISOString()}] ${req.method} ${req.url}`);
  next();
});

// ÐžÑÐ½Ð¾Ð²Ð½Ð¸Ð¹ ÐµÐ½Ð´Ð¿Ð¾Ð¹Ð½Ñ‚ Ð´Ð»Ñ Nightbot (Ð¿Ð¾Ð²ÐµÑ€Ñ‚Ð°Ñ” plain text)
app.get("/random-champion", (req, res) => {
  const randomIndex = Math.floor(Math.random() * champions.length);
  const champion = champions[randomIndex];
  const message = `Ð¢Ð¸ ÑÑ…Ð¾Ð¶Ð¸Ð¹ Ð½Ð° ${champion}`;
  
  // Ð’ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÑŽÑ”Ð¼Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¸Ð¹ Content-Type Ð´Ð»Ñ plain text
  res.type("text/plain").send(message);
});

// Ð”Ð¾Ð´Ð°Ñ‚ÐºÐ¾Ð²Ð¸Ð¹ JSON ÐµÐ½Ð´Ð¿Ð¾Ð¹Ð½Ñ‚ (Ð´Ð»Ñ Ñ‚ÐµÑÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ Ð°Ð±Ð¾ Ñ–Ð½ÑˆÐ¸Ñ… Ñ†Ñ–Ð»ÐµÐ¹)
app.get("/api/random", (req, res) => {
  const randomIndex = Math.floor(Math.random() * champions.length);
  const champion = champions[randomIndex];
  res.json({ 
    champion, 
    message: `Ð¢Ð¸ ÑÑ…Ð¾Ð¶Ð¸Ð¹ Ð½Ð° ${champion}`,
    timestamp: new Date().toISOString()
  });
});

// Ð•Ð½Ð´Ð¿Ð¾Ð¹Ð½Ñ‚ Ð´Ð»Ñ Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ð½Ð½Ñ Ð²ÑÑ–Ñ… Ñ‡ÐµÐ¼Ð¿Ñ–Ð¾Ð½Ñ–Ð²
app.get("/api/champions", (req, res) => {
  res.json({ 
    champions,
    total: champions.length
  });
});

// Ð‘Ð°Ð·Ð¾Ð²Ð¸Ð¹ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ¸ ÑÑ‚Ð°Ñ‚ÑƒÑÑƒ
app.get("/", (req, res) => {
  res.send("Nightbot Champion API Ð¿Ñ€Ð°Ñ†ÑŽÑ”! Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹Ñ‚Ðµ /random-champion Ð´Ð»Ñ Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ð½Ð½Ñ Ð²Ð¸Ð¿Ð°Ð´ÐºÐ¾Ð²Ð¾Ð³Ð¾ Ñ‡ÐµÐ¼Ð¿Ñ–Ð¾Ð½Ð°.");
});

// ÐžÐ±Ñ€Ð¾Ð±ÐºÐ° 404 Ð¿Ð¾Ð¼Ð¸Ð»Ð¾Ðº
app.use((req, res) => {
  res.status(404).send("Ð•Ð½Ð´Ð¿Ð¾Ð¹Ð½Ñ‚ Ð½Ðµ Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾");
});

app.listen(PORT, () => {
  console.log(`ðŸš€ Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð¾ Ð½Ð° http://localhost:${PORT}`);
  console.log(`ðŸ“¡ Nightbot URL: http://localhost:${PORT}/random-champion`);
});